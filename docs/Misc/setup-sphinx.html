

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Sphinx文档框架搭建速记 &mdash; Ray&#39;s sky</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="1. TEST" href="../test.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Ray's sky
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Class1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../test.html">1. TEST</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../test.html#fig">1.1. fig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#img">1.2. img</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#literal-blocks">1.3. Literal Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#line-blocks">1.4. Line Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#block-quotes">1.5. Block Quotes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#tip">1.6. tip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#compound-paragraph">1.7. compound paragraph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#guilabel">1.8. guilabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html#downloadlink">1.9. downloadlink</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Misc</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Sphinx文档框架搭建速记</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">1.1. 安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">1.2. 构建</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">1.3. 自定义顶级域名</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">1.4. 定制</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">1.4.1. 自定义404页面</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">1.4.2. 安装主题</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mathjax">1.4.3. 从外部来源加载MathJax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">1.4.4. 设置代码高亮配色</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cssjs">1.4.5. 添加自定义CSS和JS文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#favicon">1.4.6. 设置favicon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">1.5. References</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ray's sky</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>1. Sphinx文档框架搭建速记</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Misc/setup-sphinx.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sphinx">
<h1>1. Sphinx文档框架搭建速记<a class="headerlink" href="#sphinx" title="Permalink to this headline">¶</a></h1>
<p>本文是利用 <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a> 建立文档框架的过程记录，使用了 <a class="reference external" href="https://pages.github.com/">Github pages</a> 提供的静态托管服务。</p>
<div class="section" id="id2">
<h2>1.1. 安装<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Github新建名为 <code class="docutils literal notranslate"><span class="pre">blog</span></code> 的项目（名字可任意）。</p>
<p>本地创建Python项目，搭建虚拟环境。</p>
<p>执行安装：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip install -U sphinx
sphinx-quickstart
</pre></div>
</div>
<p>注意选择分离 <span class="guilabel">source</span> 和 <span class="guilabel">build</span> 文件夹的选项（输入Y并回车）。</p>
</div>
<div class="section" id="id3">
<h2>1.2. 构建<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>本地建立Git仓库，添加适用于Python开发环境的 <span class="guilabel">.gitignore</span> 文件（需要注释其中的 <span class="guilabel">build</span> 文件夹）。</p>
<p>本地项目根目录下新建 <span class="guilabel">docs</span> 文件夹。</p>
<p>在 <span class="guilabel">make.bat</span> 脚本中添加 <code class="docutils literal notranslate"><span class="pre">xcopy</span> <span class="pre">/y</span> <span class="pre">%BUILDDIR%\html\*</span> <span class="pre">%BUILDDIR%\..\docs</span> <span class="pre">/e</span></code>。此命令在执行构建指令后将生成的静态文件复制到 <span class="guilabel">docs</span> 文件夹，以供Github pages服务使用。</p>
<p>执行构建指令 <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code> ，即可在 <span class="guilabel">build\html</span> 中找到生成的静态文件。</p>
<p>将本地项目push至Github。</p>
<p>在GitHub repo设置的pages选项处将source改为“master branch /docs folder”，即可在 <code class="docutils literal notranslate"><span class="pre">https://username.github.io/blog</span></code> 浏览。</p>
</div>
<div class="section" id="id4">
<h2>1.3. 自定义顶级域名<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>DNS服务添加A记录，记录名为 <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> ，记录值为以下四者任选其一：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">185.199</span><span class="o">.</span><span class="mf">108.153</span>
<span class="mf">185.199</span><span class="o">.</span><span class="mf">109.153</span>
<span class="mf">185.199</span><span class="o">.</span><span class="mf">110.153</span>
<span class="mf">185.199</span><span class="o">.</span><span class="mf">111.153</span>
</pre></div>
</div>
<p>本地项目的 <span class="guilabel">docs</span> 文件夹里新建名为 <span class="guilabel">CNAME</span> 的文件，内容为顶级域名。</p>
<p>同时以及新建一个空的 <span class="guilabel">.nojekyll</span> 文件，并push到GitHub。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>这样做的原因是Github pages对jekyll框架的处理机制会排除 <span class="guilabel">_static</span> 文件夹。而我们的静态js和css等文件正是存在于此。排除它们的后果是加载非HTML文档时会报 <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">ERR_ABORTED</span></code> <a class="footnote-reference brackets" href="#id13" id="id5">1</a>。</p>
</div>
<p>Github项目设置的pages选项勾选Force https，稍候即可实现http自动跳转至https。</p>
</div>
<div class="section" id="id6">
<h2>1.4. 定制<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id7">
<h3>1.4.1. 自定义404页面<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>静态文件根目录手动建立 <span class="guilabel">404.html</span> 文件，在文件的最前面加上front matter后push即可 <a class="footnote-reference brackets" href="#id14" id="id8">2</a>。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">permalink</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/404.html</span>
<span class="nn">---</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>1.4.2. 安装主题<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>以 <a class="reference external" href="https://sphinx-rtd-theme.readthedocs.io/en/stable/">Read the Docs</a> 主题为例，按照 <a class="reference external" href="https://github.com/readthedocs/sphinx_rtd_theme">https://github.com/readthedocs/sphinx_rtd_theme</a> 执行即可。</p>
</div>
<div class="section" id="mathjax">
<h3>1.4.3. 从外部来源加载MathJax<a class="headerlink" href="#mathjax" title="Permalink to this headline">¶</a></h3>
<p>在插件列表中添加 <a class="reference external" href="https://www.mathjax.org/">MathJax</a> 并设置url。请注意其后所带的参数。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: source/conf.py</span>
<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="s2">&quot;sphinx.ext.mathjax&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">mathjax_path</span> <span class="o">=</span> <span class="s1">&#39;https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>1.4.4. 设置代码高亮配色<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>Sphinx使用 <a class="reference external" href="http://pygments.org/">Pygments</a> 作为默认高亮工具。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: source/conf.py</span>
<span class="n">pygments_style</span> <span class="o">=</span> <span class="s1">&#39;trac&#39;</span>
</pre></div>
</div>
<p>其中自带样式列表可在 <strong>Python命令行</strong> 中执行如下代码查看</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pygments.styles</span> <span class="kn">import</span> <span class="n">get_all_styles</span>
<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">get_all_styles</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="section" id="cssjs">
<h3>1.4.5. 添加自定义CSS和JS文件<a class="headerlink" href="#cssjs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: source/conf.py</span>
<span class="n">html_css_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;style.css&#39;</span><span class="p">]</span>
<span class="n">html_js_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;script.js&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>其中 <span class="guilabel">style.css</span> 和 <span class="guilabel">script.js</span> 位于 <code class="docutils literal notranslate"><span class="pre">html_static_path</span></code> 所指的路径。</p>
</div>
<div class="section" id="favicon">
<h3>1.4.6. 设置favicon<a class="headerlink" href="#favicon" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># file: source/conf.py</span>
<span class="n">html_favicon</span> <span class="o">=</span> <span class="s1">&#39;favicon.ico&#39;</span>
</pre></div>
</div>
<p>其中 <span class="guilabel">favicon.ico</span> 位于 <span class="guilabel">source</span> <a class="footnote-reference brackets" href="#id15" id="id12">3</a>。</p>
</div>
</div>
<div class="section" id="references">
<h2>1.5. References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id5">1</a></span></dt>
<dd><p><a class="reference external" href="https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/">https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/</a></p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id8">2</a></span></dt>
<dd><p><a class="reference external" href="https://help.github.com/cn/articles/creating-a-custom-404-page-for-your-github-pages-site">https://help.github.com/cn/articles/creating-a-custom-404-page-for-your-github-pages-site</a></p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id12">3</a></span></dt>
<dd><p><a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-html_favicon">https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-html_favicon</a></p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../test.html" class="btn btn-neutral float-left" title="1. TEST" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, curiousRay. Content licensed under CC BY 3.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-148061851', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>